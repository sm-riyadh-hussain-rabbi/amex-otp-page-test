<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Citybank OTP Page</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
  </head>

  <body>
    <main class="container min-vh-100 min-vw-100 d-flex row">
      <section
        class="d-flex flex-column justify-content-center align-items-center gap-5 col"
      >
        <!-- USER INPUT -->
        <div class="card" style="min-width: 380px">
          <div class="card-header">Citybank OTP</div>
          <div class="card-body d-flex flex-column">
            <div class="mb-3 form-group row">
              <label for="acsUrlInput" class="col-sm-3 col-form-label"
                >ACS Url</label
              >
              <div class="col-sm-9">
                <input
                  type="text"
                  id="acsUrlInput"
                  name="acsUrlInput"
                  class="form-control"
                  value="https://sandbox.thecitybank.com:4333"
                />
              </div>
            </div>
            <div class="mb-3 form-group row">
              <label for="creq" class="col-sm-3 col-form-label">CReq</label>
              <div class="col-sm-9">
                <input
                  type="text"
                  id="creqInput"
                  name="creqInput"
                  class="form-control"
                />
              </div>
            </div>
            <button onclick="initOTP()" class="btn btn-primary mt-1">
              Start OTP Process
            </button>
          </div>
        </div>
      </section>
      <!-- OTP -->
      <form
        id="payment_form"
        method="POST"
        name="theForm"
        role="form"
        action=""
      >
        <input type="hidden" id="creq" name="creq" value="" />
      </form>
    </main>
    <script type="text/javascript">
      const initOTP = () => {
        try {
          const acsUrl = document.getElementById('acsUrlInput').value
          const creq = document.getElementById('creqInput').value

          if (acsUrl === '' || creq === '') {
            return console.error('Enter acsUrl and/or creq')
          }

          document
            .getElementById('payment_form')
            ?.setAttribute('action', acsUrl)
          document.getElementById('creq')?.setAttribute('value', creq)

          console.log(document.getElementById('payment_form'))

          document.getElementById('payment_form')?.submit()
        } catch (err) {
          console.error(err)
        }
      }
    </script>
  </body>
</html>
